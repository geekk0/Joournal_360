{% extends 'base.html' %}
{% load static %}


{% block title %}
    <title>Журнал 360</title>
{% endblock %}


{% block content  %}

    <div class="bar">

        <div class="selector-container">

            <form class="selector-filter" action="{% url 'фильтр' %}" method="get">
                <label for="author"></label>


                <label for="tag"></label>
                <select id="tag" name="tag">

                    <option>Выберите тег</option>

                    {% for key, value in taglist %}


                        <option content={{ value }}>{{ value }}</option>

                    {% endfor %}

                </select>


                <select id="author" name="author">

                    <option >Выберите автора</option>

                    {% for author in group_list %}

                        <option value={{ author.id }}>{{ author }}</option>

                    {% endfor %}
                </select>

                <input type="submit" value="Применить фильтр">
            </form>

        </div>

        <div class="search-label-icon">


            <form class="search-label-icon" action="{% url 'поиск' %}" method="get">
                <input name="q" type="text" id="box" placeholder="Найти в записях...">
            </form>


        </div>

    </div>


<table class="record_layout">
    <th style="width:15%">Отчет за:</th>
    <th style="width:15%">Теги (проблемы)</th>
    <th style="width:15%">Отправил:</th>
    <th style="width:55%">Текст</th>

{%  for recs in records_list %}
    <tr>
         <td style="width:15%; text-align: center;">{{ recs.report_date }}</td>
         <td style="width:15%; text-align: center;">{{ recs.tags }}</td>
         <td style="width:15%; text-align: center;">{{ recs.author }}</td>
         {% if recs.text|length > 70 %}
                <td style="width:55%">{{recs.text|truncatechars:300 }}
                <a href="{% url 'запись' role recs.id  %}">Читать полностью</a>
         {% else %}
                 <td style="width:60%">{{recs.text }}
         {% endif %}

    </tr>



{%  endfor %}

</table>

<div class="notes_layout">

    <div>
        {% if role == 'Техдирекция' %}

            <a class="authorization" href="{% url 'добавить заметку инженеров' %}">+</a>
        {% endif %}

        {% if role == 'Режиссеры' %}

            <a class="authorization" href="{% url 'добавить заметку режиссеров' %}">+</a>
        {% endif %}
    </div>

    <p style="text-align: center">Заметки:</p>

    {%  for ns in notes %}
        <ul>
         <li class="notes_meta">{{ ns.created_date }}    {{ ns.author }} <a href="{% url 'удалить заметку' ns.id %}"
         >Удалить</a></li>
         <li class="notes_text">{{ns.message }}</li>
        </ul>

    {%  endfor %}

</div>

{% endblock %}
